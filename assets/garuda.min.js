STUDIP.Garuda={configInit:function(){$("#institute").val()!=""&&this.getConfig()},configOpenSelected:function(){$('input[type="checkbox"].selector:checked').parents("li").children('input[type="checkbox"].tree').attr("checked",true);$("span.actions a.all").each(function(){$(this).on("click",function(){$(this).parent().siblings("ul").children("li").children('input[type="checkbox"].selector').attr("checked",true)})});$("span.actions a.none").each(function(){$(this).on("click",function(){$(this).parent().siblings("ul").children("li").children('input[type="checkbox"].selector').attr("checked",
false)})})},getConfig:function(){var a=$("#institute").data("update-url").split("?"),b=a[0]+"/"+encodeURIComponent($("#institute").val());if(a[1]!="")b+="?"+a[1];$("#config").html($("<img>").attr("src",STUDIP.ASSETS_URL+"images/ajax_indicator_small.gif"));$("#config").load(b)},init:function(){if($('input[name="sendto"]:checked').val()=="all"||$('input[name="sendto"]:checked').val()=="list")$('button[name="add_filter"]').addClass("hidden-js");$('input[name="sendto"]').on("click",function(){var b=$(".filtertext").data("text-src").split("?"),
c=b[0]+"/sendto_all";if(b[1]!="")c+="?"+b[1];$(".filtertext").load(c);$(".userfilter").remove();$('input[name="sendto"]:checked').val()!="all"&&$('input[name="sendto"]:checked').val()!="list"?$('button[name="add_filter"]').removeClass("hidden-js"):$('button[name="add_filter"]').addClass("hidden-js");if($('input[name="sendto"]:checked').val()=="list"){$("#reclist").css("display","");$("#reclist textarea").attr("disabled",false)}else{$("#reclist").css("display","none");$("#reclist textarea").attr("disabled",
true)}});$(".userfilter_actions a.delete").on("click",function(b){b.preventDefault();b=$(this).parents(".userfilter");var c=b.parent();b.remove();if(c.children(".userfilter").length==0){b=c.children(".filtertext");c=b.data("text-src").split("?");var e=c[0]+"/sendto_all";if(c[1]!="")e+="?"+c[1];b.html($("<img>").attr("src",STUDIP.ASSETS_URL+"images/ajax_indicator_small.gif"));b.load(e)}});$("#reclist").css("display","none");$("#reclist textarea").attr("disabled",true);$('textarea[name="message"]').typing({stop:function(){var b=
$('textarea[name="message"]').data("preview-url").split("?");b=b[0];$("#message_preview_text").load(b,{text:encodeURIComponent($('textarea[name="message"]').val())})},delay:500});var a=$('textarea[name="message"]').width();$("#message_preview_text").width(a);$("#message_preview_text").css("max-width",a);$('textarea[name="message"]').height();$("#message_preview").css("left",a+30)},initFilter:function(){$("#add_field").on("click",function(a){a.preventDefault();a=$(".filterfield").first().clone();a.children(".fieldconfig").empty();
a.children("select").val("");$("#filterfields").append(a)})},initField:function(){$('select[name="value[]"] option').each(function(){var a=$(this).prev();if($(this).attr("value").indexOf("_children")!=-1){a.attr("class","fac");$(this).attr("class","fac_all")}if(a.attr("class")=="fac_all"||a.attr("class")=="inst")$(this).attr("class","inst")})},initRecipientView:function(){$("li.degree label").on("click",function(){var a=$(this).children("img").first(),b=a.data("toggle-icon");a.data("toggle-icon",
a.attr("src"));a.attr("src",b)});$("li.faculty label").on("click",function(){var a=$(this).children("img").first(),b=a.data("toggle-icon");a.data("toggle-icon",a.attr("src"));a.attr("src",b)})},getFieldConfig:function(a){var b=$(a).parents(".filterfield").data("relation");if(b!=""){var c=encodeURIComponent($(a).siblings('select[name="compare_operator[]"]').val()),e=encodeURIComponent($(a).val()),d=$("#"+b);a=$(a).parent().data("update-url").split("?");url=a[0]+"/"+b;var f=d.find('select[name="compare_operator[]"]').val(),
g=d.find('select[name="value[]"]').val();url+="/"+c+"/"+e;if(a[1]!="")url+="?"+a[1];d.children(".fieldconfig").html($("<img>").attr("src",STUDIP.ASSETS_URL+"images/ajax_indicator_small.gif"));d.children(".fieldconfig").load(url,function(){d.children(".fieldconfig").find('option[value="'+f+'"]').attr("selected",true);d.children(".fieldconfig").find('option[value="'+g+'"]').attr("selected",true)})}},getFilterConfig:function(a){var b=$(a).data("config-url").split("?"),c=b[0]+"/"+encodeURIComponent($(a).val());
if(b[1]!="")c+="?"+b[1];$(a).siblings(".fieldconfig").html($("<img>").attr("src",STUDIP.ASSETS_URL+"images/ajax_indicator_small.gif"));$(a).siblings(".fieldconfig").load(c)},removeFilter:function(a){$(a).parents(".userfilter").remove();a=$(".filtertext");var b=$(".userfilter").length,c=a.data("text-src").split("?");b=b==0?c[0]+"/sendto_all":b==1?c[0]+"/sendto_filtered/true":c[0]+"/sendto_filtered"+c[1];if(c[1]!="")b+="?"+c[1];a.html($("<img>").attr("src",STUDIP.ASSETS_URL+"images/ajax_indicator_small.gif"));
a.load(b);return false}};
