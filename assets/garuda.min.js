STUDIP.Garuda={configInit:function(){if($("#institute").val()!=""){this.getConfig()}},configOpenSelected:function(){$("li.degree label").click(function(a){$(this).parents("li.degree").find("span.actions").toggle()});$("li.degree").find("a.all").click(function(a){$(this).parents("li.degree").find('li.subject input[type="checkbox"]').attr("checked",true)});$("a.none").click(function(a){$(this).parents("li.degree").find('li.subject input[type="checkbox"]').attr("checked",false)});$("li.degree").find("input.subtree:checked").each(function(){$("#"+$(this).data("degree-id")).attr("checked",true);$("#actions_"+$(this).data("degree-id")).attr("style","inline")});$("li.faculty label").on("click",function(a){$(this).parents("li.faculty").find("span.actions").toggle()});$("li.faculty").find("a.all").on("click",function(a){$(this).parents("li.faculty").find('li.institute input[type="checkbox"]').each(function(){$(this).attr("checked",true)})});$("li.faculty").find("a.none").on("click",function(a){$(this).parents("li.faculty").find('li.institute input[type="checkbox"]').each(function(){$(this).attr("checked",false)})});$("li.faculty").find("input.faculty_select").on("click",function(c){var b=$(this).parents("li.faculty");var a=b.find("input.subtree");if($(this).attr("checked")){a.attr("disabled",true);a.attr("checked",true)}else{a.removeAttr("disabled");a.removeAttr("checked")}});$("li.faculty").find("input.subtree:checked").each(function(){$("#"+$(this).data("faculty-id")).attr("checked",true);$("#actions_"+$(this).data("faculty-id")).attr("style","inline")})},getConfig:function(){var a=$("#institute").data("update-url").split("?");var b=a[0]+"/"+encodeURIComponent($("#institute").val());if(a[1]!=""){b+="?"+a[1]}$("#config").html($("<img>").attr("src",STUDIP.ASSETS_URL+"images/ajax_indicator_small.gif"));$("#config").load(b)},init:function(){if($('input[name="sendto"]:checked').val()=="all"||$('input[name="sendto"]:checked').val()=="list"){$('button[name="add_filter"]').addClass("hidden-js")}$('input[name="sendto"]').on("click",function(){var a=$(".filtertext").data("text-src").split("?");var b=a[0]+"/sendto_all";if(a[1]!=""){b+="?"+a[1]}$(".filtertext").load(b);$(".userfilter").remove();if($('input[name="sendto"]:checked').val()!="all"&&$('input[name="sendto"]:checked').val()!="list"){$('button[name="add_filter"]').removeClass("hidden-js")}else{$('button[name="add_filter"]').addClass("hidden-js")}if($('input[name="sendto"]:checked').val()=="list"){$("#reclist").css("display","");$("#reclist textarea").attr("disabled",false)}else{$("#reclist").css("display","none");$("#reclist textarea").attr("disabled",true)}});$(".userfilter_actions a.delete").on("click",function(f){f.preventDefault();var d=$(this).parents(".userfilter");var b=d.parent();d.remove();if(b.children(".userfilter").length==0){var e=b.children(".filtertext");var a=e.data("text-src").split("?");var c=a[0]+"/sendto_all";if(a[1]!=""){c+="?"+a[1]}e.html($("<img>").attr("src",STUDIP.ASSETS_URL+"images/ajax_indicator_small.gif"));e.load(c)}});$("#reclist").css("display","none");$("#reclist textarea").attr("disabled",true);$('textarea[name="message"]').typing({stop:function(){var a=$('textarea[name="message"]').data("preview-url").split("?");a=a[0];$("#message_preview").load(a,{text:encodeURIComponent($('textarea[name="message"]').val())})},delay:500})},initFilter:function(){$("#add_field").on("click",function(a){a.preventDefault();var b=$(".filterfield").first().clone();b.children(".fieldconfig").empty();b.children("select").val("");$("#filterfields").append(b)})},initField:function(){$('select[name="value[]"] option').each(function(){var a=$(this).prev();if($(this).attr("value").indexOf("_children")!=-1){a.attr("class","fac");$(this).attr("class","fac_all")}if(a.attr("class")=="fac_all"||a.attr("class")=="inst"){$(this).attr("class","inst")}})},initRecipientView:function(){$("li.degree label").on("click",function(c){var a=$(this).children("img").first();var b=a.data("toggle-icon");a.data("toggle-icon",a.attr("src"));a.attr("src",b)});$("li.faculty label").on("click",function(c){var a=$(this).children("img").first();var b=a.data("toggle-icon");a.data("toggle-icon",a.attr("src"));a.attr("src",b)})},getFieldConfig:function(e){var f=$(e).parents(".filterfield");var b=f.data("relation");if(b!=""){var a=encodeURIComponent($(e).siblings('select[name="compare_operator[]"]').val());var i=encodeURIComponent($(e).val());var h=$("#"+b);var c=$(e).parent().data("update-url").split("?");url=c[0]+"/"+b;var g=h.find('select[name="compare_operator[]"]').val();var d=h.find('select[name="value[]"]').val();url+="/"+a+"/"+i;if(c[1]!=""){url+="?"+c[1]}h.children(".fieldconfig").html($("<img>").attr("src",STUDIP.ASSETS_URL+"images/ajax_indicator_small.gif"));h.children(".fieldconfig").load(url,function(){h.children(".fieldconfig").find('option[value="'+g+'"]').attr("selected",true);h.children(".fieldconfig").find('option[value="'+d+'"]').attr("selected",true)})}},getFilterConfig:function(d){var e="";var c="";var a=$(d).data("config-url").split("?");var b=a[0]+"/"+encodeURIComponent($(d).val());if(a[1]!=""){b+="?"+a[1]}$(d).siblings(".fieldconfig").html($("<img>").attr("src",STUDIP.ASSETS_URL+"images/ajax_indicator_small.gif"));$(d).siblings(".fieldconfig").load(b)},removeFilter:function(c){$(c).parents(".userfilter").remove();var e=$(".filtertext");var d=$(".userfilter").length;var a=e.data("text-src").split("?");if(d==0){var b=a[0]+"/sendto_all";if(a[1]!=""){b+="?"+a[1]}}else{if(d==1){var b=a[0]+"/sendto_filtered/true";if(a[1]!=""){b+="?"+a[1]}}else{var b=a[0]+"/sendto_filtered"+a[1];if(a[1]!=""){b+="?"+a[1]}}}e.html($("<img>").attr("src",STUDIP.ASSETS_URL+"images/ajax_indicator_small.gif"));e.load(b);return false}};